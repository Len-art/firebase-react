import * as OBJ from "webgl-obj-loader";

/* Blender export: X forward, -Z up */
export const rawPinObj = `# Blender v2.81 (sub 16) OBJ File: 'clusterShape.blend'
# www.blender.org
mtllib clusterShape.mtl
o Circle_Circle.001
v 1.000000 0.000000 0.000000
v 0.980785 -0.195090 0.000000
v 0.923880 -0.382683 0.000000
v 0.831470 -0.555570 0.000000
v 0.707107 -0.707107 0.000000
v 0.555570 -0.831470 0.000000
v 0.382683 -0.923880 0.000000
v 0.195090 -0.980785 0.000000
v 0.000000 -1.000000 0.000000
v -0.195090 -0.980785 0.000000
v -0.382683 -0.923880 0.000000
v -0.555570 -0.831470 0.000000
v -0.707107 -0.707107 0.000000
v -0.831470 -0.555570 0.000000
v -0.923880 -0.382683 0.000000
v -0.980785 -0.195090 0.000000
v -1.000000 0.000000 0.000000
v -0.980785 0.195091 0.000000
v -0.923879 0.382684 0.000000
v -0.831469 0.555571 0.000000
v -0.707106 0.707107 0.000000
v -0.555570 0.831470 0.000000
v -0.382683 0.923880 0.000000
v -0.195089 0.980785 0.000000
v 0.000001 1.000000 0.000000
v 0.195091 0.980785 0.000000
v 0.382684 0.923879 0.000000
v 0.555571 0.831469 0.000000
v 0.707108 0.707106 0.000000
v 0.831470 0.555569 0.000000
v 0.923880 0.382682 0.000000
v 0.980786 0.195089 0.000000
vt 1.290634 0.656824
vt 1.244425 0.805725
vt 1.170054 0.942752
vt 1.070381 1.062635
vt 0.949237 1.160769
vt 0.811273 1.233383
vt 0.661791 1.277688
vt 0.516822 1.297674
vt 0.353848 1.275729
vt 0.202584 1.229499
vt 0.065559 1.155129
vt -0.054326 1.055455
vt -0.152460 0.934309
vt -0.225076 0.796344
vt -0.269380 0.646865
vt -0.283670 0.491615
vt -0.267399 0.336561
vt -0.221189 0.187657
vt -0.146820 0.050632
vt -0.047145 -0.069252
vt 0.074002 -0.167388
vt 0.211965 -0.240002
vt 0.361445 -0.284306
vt 0.516695 -0.298597
vt 0.671749 -0.282326
vt 0.820652 -0.236116
vt 0.957679 -0.161745
vt 1.077562 -0.062072
vt 1.175698 0.059076
vt 1.248311 0.197039
vt 1.292615 0.346519
vt 1.306906 0.501768
vn 0.0000 0.0000 -1.0000
usemtl None
s off
f 2/1/1 3/2/1 4/3/1 5/4/1 6/5/1 7/6/1 8/7/1 9/8/1 10/9/1 11/10/1 12/11/1 13/12/1 14/13/1 15/14/1 16/15/1 17/16/1 18/17/1 19/18/1 20/19/1 21/20/1 22/21/1 23/22/1 24/23/1 25/24/1 26/25/1 27/26/1 28/27/1 29/28/1 30/29/1 31/30/1 32/31/1 1/32/1
`;

// let's try to use mesh directly, read OBJ documentation
const mesh = new OBJ.Mesh(rawPinObj);

const group1dto2d = (n: number[]) =>
  n.reduce((a: number[][], v, i) => {
    if (i % 2) {
      a[a.length - 1][1] = v;
    } else {
      a.push([v]);
    }
    return a;
  }, []);

const groupedVertices = group1dto2d(
  mesh.vertices.filter((v, i) => (i + 1) % 3 !== 0)
);

const groupedTextureMap = group1dto2d(mesh.textures);

export default { mesh, groupedVertices, groupedTextureMap };
