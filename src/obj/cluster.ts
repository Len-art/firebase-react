import * as OBJ from "webgl-obj-loader";

/* Blender export: X forward, Z up */
export const rawPinObj = `# Blender v2.81 (sub 16) OBJ File: 'clusterShape.blend'
# www.blender.org
mtllib clusterShape.mtl
o Circle_Circle.001
v 1.000000 0.000000 0.000000
v 0.980785 0.195090 0.000000
v 0.923880 0.382683 0.000000
v 0.831470 0.555570 0.000000
v 0.707107 0.707107 0.000000
v 0.555570 0.831470 0.000000
v 0.382683 0.923880 0.000000
v 0.195090 0.980785 0.000000
v 0.000000 1.000000 0.000000
v -0.195090 0.980785 0.000000
v -0.382683 0.923880 0.000000
v -0.555570 0.831470 0.000000
v -0.707107 0.707107 0.000000
v -0.831470 0.555570 0.000000
v -0.923880 0.382683 0.000000
v -0.980785 0.195090 0.000000
v -1.000000 -0.000000 0.000000
v -0.980785 -0.195091 0.000000
v -0.923879 -0.382684 0.000000
v -0.831469 -0.555571 0.000000
v -0.707106 -0.707107 0.000000
v -0.555570 -0.831470 0.000000
v -0.382683 -0.923880 0.000000
v -0.195089 -0.980785 0.000000
v 0.000001 -1.000000 0.000000
v 0.195091 -0.980785 0.000000
v 0.382684 -0.923879 0.000000
v 0.555571 -0.831469 0.000000
v 0.707108 -0.707106 0.000000
v 0.831470 -0.555569 0.000000
v 0.923880 -0.382682 0.000000
v 0.980786 -0.195089 0.000000
vt 1.299840 0.421223
vt 1.299840 0.578778
vt 1.269102 0.733306
vt 1.208809 0.878867
vt 1.121277 1.009868
vt 1.009869 1.121276
vt 0.878867 1.208809
vt 0.733305 1.269103
vt 0.578777 1.299840
vt 0.421223 1.299840
vt 0.266696 1.269103
vt 0.121134 1.208809
vt -0.009868 1.121277
vt -0.121277 1.009868
vt -0.208809 0.878866
vt -0.269103 0.733304
vt -0.299840 0.578779
vt -0.299840 0.421222
vt -0.269103 0.266696
vt -0.208809 0.121134
vt -0.121276 -0.009869
vt -0.009868 -0.121276
vt 0.121134 -0.208809
vt 0.266696 -0.269103
vt 0.421221 -0.299840
vt 0.578777 -0.299840
vt 0.733306 -0.269102
vt 0.878867 -0.208809
vt 1.009870 -0.121275
vt 1.121277 -0.009868
vt 1.208810 0.121135
vt 1.269103 0.266695
vn 0.0000 0.0000 1.0000
usemtl None
s off
f 2/1/1 3/2/1 4/3/1 5/4/1 6/5/1 7/6/1 8/7/1 9/8/1 10/9/1 11/10/1 12/11/1 13/12/1 14/13/1 15/14/1 16/15/1 17/16/1 18/17/1 19/18/1 20/19/1 21/20/1 22/21/1 23/22/1 24/23/1 25/24/1 26/25/1 27/26/1 28/27/1 29/28/1 30/29/1 31/30/1 32/31/1 1/32/1
`;

// let's try to use mesh directly, read OBJ documentation
const mesh = new OBJ.Mesh(rawPinObj);

const group1dto2d = (n: number[]) =>
  n.reduce((a: number[][], v, i) => {
    if (i % 2) {
      a[a.length - 1][1] = v;
    } else {
      a.push([v]);
    }
    return a;
  }, []);

const groupedVertices = group1dto2d(
  mesh.vertices.filter((v, i) => (i + 1) % 3 !== 0)
);

const groupedTextureMap = group1dto2d(mesh.textures);

export default { mesh, groupedVertices, groupedTextureMap };
